(function($){class a{constructor(b){this._options=$.extend({},this.defaults(),b);this.regex=()=>({superscript:()=>/\^([0-9])\^/g,superfoot:()=>/\^([0-9])\s?:\s?\{\s?([^}]+)\s?\}/g,subscript:()=>/~(([0-9]))~/g,subfoot:()=>/~([0-9])\s?:\s?\{\s?([^}]+)\s?\}/g});this.$scripts=$('p').toArray().filter(p=>{const c=$(p).text(),{superscript:d,subscript:f}=this.regex();return d().test(c)||f().test(c)});this.$footnotes=$('p').toArray().filter(p=>{const c=$(p).text(),{superfoot:d,subfoot:f}=this.regex();return d().test(c)||f().test(c)});this.$paragraphs=$.uniqueSort(this.$scripts.concat(this.$footnotes));return this.process()}process(){this.$paragraphs.forEach(p=>{let b=$(p).text();const{superscript:c,subscript:d,superfoot:f,subfoot:g}=this.regex(),h=array=>array===null?[]:array;h(b.match(c())).forEach(m=>{const n=c().exec(m)[1];b=b.replace(m,this.getMarkUp(!0,!0,n))});h(b.match(d())).forEach(m=>{const n=d().exec(m)[1];b=b.replace(m,this.getMarkUp(!0,!1,n))});const{footnotes:i}=this.options(),j=!i.show?'display: none;':'',k=h(b.match(f())).map(m=>{const n=f().exec(m),o=n[1],q=n[2],r=this.getMarkUp(!1,!0,o,q);b=b.replace(m,'');return r}).join('');b=$.isEmptyObject(k)?b:`${b} <ol class="smallfoot footnotes supfoots" style="${j}">
             ${k}
          </ol>`;const l=h(b.match(g())).map(m=>{const n=g().exec(m),o=n[1],q=n[2],r=this.getMarkUp(!1,!1,o,q);b=b.replace(m,'');return r}).join('');b=$.isEmptyObject(l)?b:`${b} <ul class="smallfoot footnotes subfoots" style="${j}">
          ${l}
        </ul>`;if(b!=='')$(p).replaceWith(`<p>${b}</p>`)});return this}getMarkUp(b,c,d,f){const{references:g}=this.options(),h=c?'sup':'sub',{useDiv:i}=g,j=i?'div':h;return b?`
          <${j} class="smallfoot ${h}script reference" id="${h}-fn-${d}">
            <a href="#sup-fn-ref-${d}" rel="footnote">${d}</a>
          </${j}>`:`<li>
            <div class="smallfoot ${h}script footnote">
              <p id="${h}-fn-ref-${d}">
                ${f}<a href="#${h}-fn-${d}" title="return to article"> â†©</a>
              <p>
            </div>
          </li>`}defaults(){return{references:{useDiv:!1},footnotes:{show:!0}}}options(b){this._options=b?$.extend({},this._options,b):this._options;return this._options}ready(b=()=>{}){b({references:$('.smallfoot.reference').toArray(),footnotes:$('.smallfoot.footnote').toArray()});return this}on(b,c=()=>{}){$('.smallfoot').filter('.reference').toArray().forEach(el=>$(el).bind(b,e=>{let d=$(e.target);const f=element=>$(element).hasClass('superscript')?'superscript':'subscript';switch($(e.target).get(0).tagName.toLowerCase()){case'p':d=$(d).filter('sup');return c({event:e,type:f(d),target:d});case'sup':return c({event:e,type:f(d),target:d});case'sub':return c({event:e,type:f(d),target:d});case'a':d=$(d).parent();return c({event:e,type:f(d),target:d});}}));return this}onClick(b=()=>{}){return this.on('click',b)}onMouseEnter(b=()=>{}){return this.on('mouseenter',b)}onMouseLeave(b=()=>{}){return this.on('mouseleave',b)}}$.smallfoot=options=>new a(options)})($||jQuery);